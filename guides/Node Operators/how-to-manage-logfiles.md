---
title: How to manage log files
hide_title: true
slug: how-to-manage-log-files
date: 2023-10-27T12:00:00Z
image: ./assets/managing-the-keystore.png?202311181211
description: Learn how to rotate, compress the log files
category: Tutorial
tags:
- guide
- logs
---

![How to manage log files](./assets/how-to-manage-log-files.png?202310271441)

import Author from '@site/src/components/Author';

## Introduction

The Fleek Network Node streams text messages to the standard out and standard error in Linux. A considerable high number of text data that can cause concern because of the file sizes in the limited amount of disk space available.

A conventional Fleek Network Service setup, as per the documentation and tool recommendations, have it stored in a special directory for storing logs called /var/log. The /var/log directory cotnains logs from various applications running on the operating system, the operating system itself, and other services.

For the purpose of storing Fleek Network Node operation logs, it defaults to store in the /var/log/lightning directory where the files output.log (stdout) and diagnostic.log (stderr) accumulate the text data. As the node runs, the size of the files increase, as it aggregates all the output generated by the Fleek Network service operations.

To mitigate any concerns or issues, a Node Operator can configure the system to rotate, compress, set maximum size of these files.

In this guide, we'll look into some options available to manage the logs. First, we'll look into journald.conf which controls where to store journal dataâ€“the journal is a component of systemd that handles all the messages in a Systemd enabled system. Afterwards, we'll look into Logrotate an application to help us manage automatic rotation and compression of log files.

## Journal

Journal is a component of Systemd, a centralized location for all messages logged by different components in a systemd-enabled Linux system. The systemd journal will happily run in parallel with the standard type log files in `/var/log/*` where the Fleek Network Systemd Unit Service outputs Standard Output and Standard Error `/var/log/lightning/*.log`.

Here, we are going to learn how to configure the `journald.conf` service configuration file for the system wide settings (applies to all services), but firstly we're going to learn some handful of commands to help us find troubleshoot in the future.

### Commands

#### Disk utilization checkup

To check how much disk space is used by systemd log files, run the command below:

```
journalctl --disk-usage
```

Provides how much disk space is utilized by the log files in your system.

#### Clearing logs manually

The best way to clear log files is done automatically by the `journald.conf` configuration file, discussed in [Configuration file](#configuration-file). In the ideal world, you shouldn't have to manually delete the log files, but this can be useful to know about when troubleshooting.

To `flush` the log files run the command below:

```
sudo journalctl --flush --rotate
sudo journalctl --vacuum-time=1s
```

:::tip
The flush and rotate flag is used, as vaccum-time only clears archived logs, not active ones. It'll flush (/run/log/journal to /var/log/journal), rotate (this flag archives logs) and retain only keeps the past 1-second-long files, effectively clearing everything.
:::

#### Follow or tail logs of service

```
journalctl -u <SERVICE-NAME>.service -f
```

For example, for a conventional native install (if you haven't followed the conventions, make the appropriate tweaks to fit your needs).

```
journalctl -u lightning.service -f
```

The Docker service

```
journalctl -u docker-lightning.service -f
```

#### Show all service entries

Show all journal entries, which can be fairly long:

```
journalctl
```

### Configuration file

The default configuration file is located at `/etc/systemd/journald.conf`. This is the main file that journal reads the configuration from, for the system instances that are controlled by root.

In addition to the main configuration file there are a few other locations that take higher precedence and override the main configuration file. To learn more about journald read [here](https://www.freedesktop.org/software/systemd/man/latest/journald.conf.html#Options).

To keep the guide short we are going to use the main location `/etc/systemd/journald.conf`.

### Create the directory and config file

If the `/etc/systemd/journald.conf` file doesn't exist, create it by:

Create the `journald.conf` file:

```
sudo touch /etc/systemd/journald.conf
```

### Configuration settings

The systemd provides many options for you to manage the log files and by combining these parameters you can limit the disk space used by the journal files.

A list of the available options are [here](https://www.freedesktop.org/software/systemd/man/latest/journald.conf.html#Options).

Here is a quick description of the options we're going to use for our example:

- **Storage**, controls where to store journal data	
- **SystemMaxUse**, specifies the maximum disk space that can be used by the journal in persistent storage
- **SystemMaxFileSize**, controls how large individual journal files can grow to in persistent storage before being rotated.
- **RuntimeMaxUse**, control how much disk space the journal may use up at most.

You should open the `/etc/systemd/journald.conf` file in your favorite text editor and put:

```toml
[Journal]
Storage=persistent
SystemMaxUse=100M
SystemMaxFileSize=100M
RuntimeMaxUse=100M
```

Here, we set 100M, which means 100 Megabytes. You can also use K for Kbytes, G for Gbytes, amongst others.

After the changes, you have to restart the journald after updating the file, to restart use the command:

```
sudo systemctl restart systemd-journald
```

You can verify the integrity of the log files by running:

```
journalctl --verify
```

## Logrotate



## Conclusion

<Author
    name="Helder Oliveira"
    image="https://github.com/heldrida.png"
    title="Software Developer + DX"
    url="https://github.com/heldrida"
/>